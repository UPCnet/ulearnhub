<!doctype html>
<html metal:use-macro="api.masterTemplate.macros['master']">
<head></head>
<body>

  <metal:main fill-slot="main">
<div ng-app="uLearnUsers">


    <h1 class="page-header">Registered Users</h1>
    <div metal:use-macro="api.masterTemplate.macros['sections']"></div>


  		<oauthinfo username="${api.authenticated_user}" 
                 maxserver="${api.domain.server}"
                 oauthtoken="${api.authenticated_user_token}">
      </oauthinfo>

  		<ul class="nav nav-tabs">
  			<li role="presentation" class="active"><a data-toggle="tab" href="#manage">Manage</a></li>
  			<li role="presentation" ><a data-toggle="tab" href="#roles">Roles</a></li>
  		</ul>

      <div id="my-tab-content" class="tab-content">
        <div class="tab-pane fade in active" id="manage" ng-controller="UsersManageController as userMan">
          <br/>
  	     <table datatable="ng" dt-options="userMan.dtOptions" dt-column-defs="userMan.dtColumnDefs" class="compact table table-striped">
              <thead>
                <tr>
                  <th>UserName</th>
                  <th>DisplayName</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr ng-repeat="user in userMan.users">
                  <td><a href="${api.application_url}/domains/${api.domain.name}/users/{{user.username}}">{{user.username}}</a></td>
                  <td>{{user.displayName}}</td>
                  <td> 
                    <a href=""><img src="${api.application_url}/static/editar.jpg" alt="Editar usuario" height="21" width="21"></a> &nbsp;&nbsp;
                    <a href=""><img src="${api.application_url}/static/borrar.jpg" alt="Eliminar usuario" height="21" width="21"></a>

                  </td>

                </tr>
              </tbody>
  	     </table>

          <hr>
          <div class="view-actions pull-right">
            <button class="btn btn-primary" ng-click="userMan.open()">New User</button>
          </div>


          <script type="text/ng-template" id="new-user.html">
              <div class="modal-header">
                  <h3 class="modal-title">Add new user</h3>
              </div>
              <div class="modal-body">

              <form>
                <div class="form-group">
                  <label for="userName">UserName</label>
                  <input ng-model="newuser.username" type="text" class="form-control" id="userName" placeholder="Enter Username">
                </div>

                <div class="form-group">
                  <label for="displayName">DisplayName</label>
                  <input ng-model="newuser.displayName" type="text" class="form-control" id="displayName" placeholder="Enter displayName">
                </div>

              </form>

              <alert ng-repeat="alert in alerts" type="{{alert.type}}" close="closeAlert($index)">{{alert.msg}}</alert>

              </div>
              <div class="modal-footer">
                  <button class="btn btn-primary" ng-click="ok()">OK</button>
                  <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
              </div>
          </script>



        </div>

        <div class="tab-pane fade" id="roles" ng-controller="UsersRolesController as userRol">
          <br/>
         <table datatable="ng" dt-options="userRol.dtOptions" dt-column-defs="userRol.dtColumnDefs" class="compact table table-striped">
              <thead>
                <tr>
                  <th>UserName</th>
                  <th>Manager</th>
                  <th>NonVisible</th>
                  <th>HubManager</th>

                </tr>
              </thead>
              <tbody>
                <tr ng-repeat="user in userRol.users">
                  <td>{{user.username}}</td>

                  <td ng-repeat="role in user.roles"><input type="checkbox" ng-change="userRol.changeRole(role.active, role.name,user.username)" ng-model="role.active"></td>
                </tr>
              </tbody>
         </table>
        </div>

      </div>
    </div>

  </metal:main>

<metal:main fill-slot="view_scripts">
    <script src="${api.application_url}/js/MAXClient.js"></script>
    <script src="${api.application_url}/js/users.js"></script>
</metal:main>


</body>
</html>

